function Slidezy(selector,options={}){this.container=document.querySelector(selector);if(!this.container){throw new Error(`Slidezy: Container "${selector}" not found!`)}this.opt=Object.assign({items:1,loop:false,speed:300,pagination:true,controls:true,controlsText:["<",">"],prevButton:null,nextButton:null,slideBy:1,autoplay:false,autoplayDelay:3e3,autoplayPauseOnHover:true,swipe:true,swipeThreshold:50,swipeVelocityThreshold:1.4,touchRatio:1,resistanceRatio:.2},options);if(!Number.isFinite(this.opt.items)||this.opt.items<1){console.warn(`Slidezy: Invalid "items" value: "${this.opt.items}". `+`Value must be a finite number greater than or equal to 1. `+`Using fallback value of 1.`);this.opt.items=1}this.slides=Array.from(this.container.children);this._slideCount=this.slides.length;this.currentIndex=this.opt.loop?this._getCloneCount():0;this._maxIndex=this.slides.length-this.opt.items;this._init();this._updatePosition()}Slidezy.prototype._init=function(){this.container.classList.add("slidezy-wrapper");if(this._slideCount<=this.opt.items){const reason="slideCount is less than or equal to items.";if(this.opt.loop){this.opt.loop=false;console.warn(`Slidezy: "loop" option was disabled because ${reason}`)}if(this.opt.autoplay){this.opt.autoplay=false;console.warn(`Slidezy: "autoplay" option was disabled because ${reason}`)}if(this.opt.controls){this.opt.controls=false;console.warn(`Slidezy: "controls" option was disabled because ${reason}`)}if(this.opt.pagination){this.opt.pagination=false;console.warn(`Slidezy: "pagination" option was disabled because ${reason}`)}}this._createContent();this._createTrack();this.opt.controls&&this._createControls();this.opt.pagination&&this._createPagination();if(this.opt.autoplay){this._startAutoplay();this.opt.autoplayPauseOnHover&&this._setupAutoplayHover()}this._swipeState={isTouching:false,isDragging:false,isVerticalScroll:false,startX:0,startY:0,currentX:0,startTime:0,currentTranslate:0,prevTranslate:0,rafId:null};this.opt.swipe&&this._setupSwipe()};Slidezy.prototype._setupSwipe=function(){this._boundTouchStart=this._onTouchStart.bind(this);this._boundTouchMove=this._onTouchMove.bind(this);this._boundTouchEnd=this._onTouchEnd.bind(this);this.content.addEventListener("touchstart",this._boundTouchStart,{passive:false});this.content.addEventListener("touchmove",this._boundTouchMove,{passive:false});this.content.addEventListener("touchend",this._boundTouchEnd);this.content.addEventListener("touchcancel",this._boundTouchEnd);this.content.addEventListener("contextmenu",e=>{if(this._swipeState.isDragging){e.preventDefault()}});const images=this.track.querySelectorAll("img");images.forEach(img=>{img.addEventListener("dragstart",e=>e.preventDefault())});this.track.style.userSelect="none";this.track.style.webkitUserSelect="none"};Slidezy.prototype._onTouchStart=function(e){if(this._isMoving)return;if(e.touches&&e.touches.length>1)return;const touch=e.touches[0];const state=this._swipeState;state.isTouching=true;state.isDragging=false;state.startX=touch.clientX;state.startY=touch.clientY;state.currentX=touch.clientX;state.startTime=Date.now();state.isVerticalScroll=false;state.prevTranslate=-(this.currentIndex*(100/this.opt.items));state.currentTranslate=state.prevTranslate;state.wasAutoplay=!!this.autoplayId;if(state.wasAutoplay)this._stopAutoplay()};Slidezy.prototype._onTouchMove=function(e){if(!this._swipeState.isTouching)return;if(this._swipeState.isVerticalScroll)return;const touch=e.touches[0];const state=this._swipeState;state.currentX=touch.clientX;const deltaX=touch.clientX-state.startX;const deltaY=touch.clientY-state.startY;if(!state.isDragging){if(Math.abs(deltaY)>Math.abs(deltaX)){state.isVerticalScroll=true;return}if(Math.abs(deltaX)>5){e.preventDefault();state.isDragging=true;this.track.style.transition="none";this.slides.forEach(slide=>{slide.style.pointerEvents="none"})}else{return}}else{e.preventDefault()}const containerWidth=this.content.clientWidth;const movePercentage=deltaX/containerWidth*100*this.opt.touchRatio;state.currentTranslate=state.prevTranslate+movePercentage;if(!this.opt.loop){const minTranslate=-(this._maxIndex*(100/this.opt.items));const maxTranslate=0;if(state.currentTranslate>maxTranslate){state.currentTranslate=maxTranslate+(state.currentTranslate-maxTranslate)*this.opt.resistanceRatio}else if(state.currentTranslate<minTranslate){state.currentTranslate=minTranslate+(state.currentTranslate-minTranslate)*this.opt.resistanceRatio}}if(this._swipeState.rafId)cancelAnimationFrame(this._swipeState.rafId);this._swipeState.rafId=requestAnimationFrame(()=>{this.track.style.transform=`translateX(${state.currentTranslate}%)`})};Slidezy.prototype._onTouchEnd=function(e){if(!this._swipeState.isTouching)return;const state=this._swipeState;this.slides.forEach(slide=>{slide.style.pointerEvents=""});if(!state.isDragging){state.isTouching=false;setTimeout(()=>{if(state.wasAutoplay)this._startAutoplay()},10);return}const deltaX=state.currentX-state.startX;const deltaTime=Math.max(1,Date.now()-state.startTime);const velocity=Math.abs(deltaX)/deltaTime;let slidesToMove=0;const{swipeThreshold:swipeThreshold,swipeVelocityThreshold:swipeVelocityThreshold}=this.opt;const containerWidth=this.content.clientWidth;if(velocity>swipeVelocityThreshold&&Math.abs(deltaX)<containerWidth*.75){slidesToMove=deltaX>0?-1:1}else if(velocity>swipeVelocityThreshold&&Math.abs(deltaX)>containerWidth*.75){slidesToMove=deltaX>0?-this.opt.items:this.opt.items}else if(Math.abs(deltaX)>swipeThreshold){const slideWidth=containerWidth/this.opt.items;slidesToMove=-Math.round(deltaX/slideWidth)}if(slidesToMove!==0){this.moveSlide(slidesToMove)}else{this.track.style.transition=`transform ${this.opt.speed}ms ease`;this._updatePosition()}state.isTouching=false;state.isDragging=false;if(this._swipeState.rafId)cancelAnimationFrame(this._swipeState.rafId);if(state.wasAutoplay)this._startAutoplay()};Slidezy.prototype._startAutoplay=function(){if(this.autoplayId)return;const slideBy=this._getSlideBy();this.autoplayId=setInterval(()=>{this.moveSlide(slideBy)},this.opt.autoplayDelay)};Slidezy.prototype._stopAutoplay=function(){if(this.autoplayId){clearInterval(this.autoplayId);this.autoplayId=null}};Slidezy.prototype._setupAutoplayHover=function(){this.content.addEventListener("mouseenter",()=>this._stopAutoplay());this.content.addEventListener("mouseleave",()=>this._startAutoplay())};Slidezy.prototype._createContent=function(){this.content=document.createElement("div");this.content.className="slidezy-content";this.container.appendChild(this.content)};Slidezy.prototype._getCloneCount=function(){if(this._slideCount<=this.opt.items)return 0;const slideBy=this._getSlideBy();const cloneCount=this.opt.items+slideBy;return cloneCount>this._slideCount?this._slideCount:cloneCount};Slidezy.prototype._createTrack=function(){this.track=document.createElement("div");this.track.className="slidezy-track";const{items:items,loop:loop}=this.opt;const cloneCount=this._getCloneCount();if(loop&&cloneCount>0){const cloneHead=this.slides.slice(-cloneCount).map(slide=>slide.cloneNode(true));const cloneTail=this.slides.slice(0,cloneCount).map(slide=>slide.cloneNode(true));this.slides=cloneHead.concat(this.slides).concat(cloneTail)}const fragment=document.createDocumentFragment();this.slides.forEach(slide=>{slide.classList.add("slidezy-slide");slide.style.flexBasis=`calc(100% / ${items})`;fragment.appendChild(slide)});this.track.appendChild(fragment);this.content.appendChild(this.track);this._maxIndex=this.slides.length-items};Slidezy.prototype._createPagination=function(){const{items:items,loop:loop}=this.opt;this.paginationWrapper=document.createElement("div");this.paginationWrapper.classList.add("slidezy-pagination");const pageCount=Math.ceil(this._slideCount/items);for(let i=0;i<pageCount;i++){const paginationBtn=document.createElement("button");paginationBtn.classList.add("slidezy-pagination-button");paginationBtn.addEventListener("click",()=>{const cloneCount=loop?this._getCloneCount():0;const targetIndex=cloneCount+i*items;const step=targetIndex-this.currentIndex;this.moveSlide(step)});this.paginationWrapper.appendChild(paginationBtn)}this.container.appendChild(this.paginationWrapper);this.paginationBtns=Array.from(this.paginationWrapper.children)};Slidezy.prototype._updatePagination=function(){if(!this.paginationWrapper)return;const{items:items,loop:loop}=this.opt;let realIndex=this.currentIndex;if(loop){realIndex=(this.currentIndex-this._getCloneCount()+this._slideCount)%this._slideCount}let pageIndex=Math.floor(realIndex/items);if(!loop&&realIndex===this._maxIndex){const pageCount=Math.ceil(this._slideCount/items);pageIndex=pageCount-1}this.paginationBtns.forEach((btn,index)=>{btn.classList.toggle("active",pageIndex===index)})};Slidezy.prototype._createControls=function(){const{prevButton:prevButton,nextButton:nextButton,loop:loop}=this.opt;if(prevButton){if(prevButton.nodeType===Node.ELEMENT_NODE){this.prevBtn=prevButton}else if(typeof prevButton==="string"){this.prevBtn=document.querySelector(prevButton);if(!this.prevBtn)throw new Error(`Slidezy: Custom "prevButton" selector "${prevButton}" did not match any element in the DOM.`)}else{throw new TypeError(`Slidezy: Option "prevButton" must be a string (CSS selector) or an Element. Received type: ${typeof prevButton}.`)}}else{this.prevBtn=document.createElement("button");this.prevBtn.type="button";this.prevBtn.className="slidezy-prev";this.prevBtn.textContent=this.opt.controlsText[0];this.content.appendChild(this.prevBtn)}if(nextButton){if(nextButton.nodeType===Node.ELEMENT_NODE){this.nextBtn=nextButton}else if(typeof nextButton==="string"){this.nextBtn=document.querySelector(nextButton);if(!this.nextBtn)throw new Error(`Slidezy: Custom "nextButton" selector "${nextButton}" did not match any element in the DOM.`)}else{throw new TypeError(`Slidezy: Option "nextButton" must be a string (CSS selector) or an Element. Received type: ${typeof nextButton}.`)}}else{this.nextBtn=document.createElement("button");this.nextBtn.type="button";this.nextBtn.className="slidezy-next";this.nextBtn.textContent=this.opt.controlsText[1];this.content.appendChild(this.nextBtn)}if(this.prevBtn===this.nextBtn)throw new Error("prevButton and nextButton must be different elements");const stepBy=this._getSlideBy();this.prevBtn.addEventListener("click",()=>{this.moveSlide(-stepBy)});this.nextBtn.addEventListener("click",()=>{this.moveSlide(stepBy)});if(!loop)this._disableBtn()};Slidezy.prototype._getSlideBy=function(){const num=this.opt.slideBy==="page"?this.opt.items:Number(this.opt.slideBy);if(!Number.isFinite(num)||num<1){console.warn(`Slidezy: Invalid "slideBy" value: "${this.opt.slideBy}". `+`Value must be 'page' or a finite number greater than or equal to 1. `+`Using fallback value of 1.`);return 1}return num};Slidezy.prototype.moveSlide=function(step){if(this._isMoving)return;this._isMoving=true;this.currentIndex=Math.min(Math.max(this.currentIndex+step,0),this._maxIndex);setTimeout(()=>{if(this.opt.loop){this._handleLoop()}this._isMoving=false},this.opt.speed);if(!this.opt.loop)this._disableBtn();this._updatePosition()};Slidezy.prototype._handleLoop=function(){const cloneCount=this._getCloneCount();const tailBoundary=this._maxIndex-cloneCount;if(this.currentIndex>tailBoundary){this.currentIndex-=this._slideCount;this._updatePosition(true)}else if(this.currentIndex<cloneCount){this.currentIndex+=this._slideCount;this._updatePosition(true)}};Slidezy.prototype._updatePosition=function(instant=false){this.track.style.transition=instant?"none":`transform ${this.opt.speed}ms ease`;this.offset=-(this.currentIndex*(100/this.opt.items));this.track.style.transform=`translateX(${this.offset}%)`;if(this.opt.pagination&&!instant)this._updatePagination()};Slidezy.prototype._disableBtn=function(){if(!this.prevBtn||!this.nextBtn)return;this.prevBtn.classList.toggle("disable",this.currentIndex<=0);this.nextBtn.classList.toggle("disable",this.currentIndex>=this._maxIndex)};